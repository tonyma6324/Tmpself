https://zhuanlan.zhihu.com/p/616109439
在使用weak函数的时候有时会遇到一些问题
gcc在链接静态库的时候弱函数可能会失效！！！！

gcc 在链接静态库时，默认的行为是只要找到第一个（不管是不是弱符号），就会将其链接，然后停止继续寻找，这样一来，如果你的 weak 是被第一个找到的，那么强定义的函数就失效了。


解决方案：

1,使用 "-Wl,--whole-archive" 选项来解决。当使用这个选项时，链接器将整个库文件都包含在链接输出文件中，而不考虑这些库文件是否实际上被使用了。这样就可以保证弱符号在整个库中得到了正确的链接，并且在可执行文件或其他库中保持有效。

需要注意的是，当使用 "-Wl,--whole-archive" 选项时，可能会将一些不必要的库文件链接到最终的可执行文件或库中，这可能会增加最终文件的大小。因此，应该仅在必要时使用这个选项。
